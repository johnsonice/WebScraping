震网电脑蠕虫背后的思想
其实非常简单。
我们不希望伊朗拥有核武器。
他们用于开发核武器的主要设备
是纳坦兹的铀浓缩设施。
各位看到的灰盒子
是实时控制系统。
如果我们设法侵入这些
控制驱动器的速度和阀门的系统中，
我们实际上可以用离心机
造成很多问题。
这个灰盒子不能运行Windows软件；
它们用的是完全不同的技术。
但如果我们设法
把一个Windows病毒
放到一名
设备工程师用于配置
这个灰盒子的笔记本上，
然后我们就可以开始行动了。
这就是震网病毒背后的阴谋。
那么我从一个Windows注入器开始。
它携带的病毒传播到灰盒子，
破坏离心机，
伊朗核项目延迟 --
任务完成。
很容易，是吧？
我想告诉大家我们是如何发现这些的。
当六个月前我们开始研究震网病毒时，
我们对它的目的一无所知。
唯一知道的是，
它的Windows部分，注入器部分非常非常复杂，
使用了多重零日漏洞攻击。
它似乎想要对
这些灰盒子，这些实时控制系统做些什么。
这引起了我们的注意，
我们启动了一个实验室项目，
用震网病毒感染我们的系统，
并进行了仔细的检查。
接着一些非常有趣的事发生了。
震网病毒表现的像只
不喜欢起司的大白鼠 --
嗅一嗅起司，但并不想吃。
我有些不理解。
而在我们实验了各种不同的起司之后，
我意识到，这是一个定向攻击。
它完全是定向的。
如果找到了特定的配置，
注入器就会
主动潜入灰盒子里，
即使它正试图感染的实际的程序
也在干着同样的事儿。
如果没有找到目标，震网病毒什么也不做。
这确实引起了我的注意，
我们开始昼夜不停的
对这个进行研究，
因为我觉得我们还不知道它的目标呢。
目标也许是，打个比方，
一座美国发电厂，
或德国的化工厂。
因此我们最好尽快找出它的目标。
我们提取并反编译了
攻击代码，
发现它包含两个数字炸弹 --
一个小些的和一个大些的。
而我们也发现，它们是被了解所有内幕信息的人
非常专业地制作出来的。
他们了解所要攻击
目标的所有细节。
他们甚至知道操作员鞋子的号码。
他们知道一切。
如果各位曾经听说过，震网病毒的注入器
复杂且是高科技的，
让我告诉各位：
它携带的病毒非常复杂。
这远超过我们
曾经见过的技术。
在这儿各位能看到实际的攻击代码的片段。
我们在讨论 --
大约1万5千行代码。
看起来很像旧式的汇编语言。
我想告诉各位我们是
如何弄明白这些代码的。
我们首先要寻找的是系统函数调用，
因为我们知道这些函数做什么。
然后我们要找到定时器和数据结构，
接着尝试把它们和现实世界联系起来 --
与潜在的现实世界目标联系起来。
因此我们需要目标理论
我们能用它来证实与否。
为了得到目标理论，
我们记得
这绝对会造成严重的破坏，
因此必然有个高价值的目标，
而且很有可能就位于伊朗境内，
因为在伊朗报告的病毒感染最多。
在这一区域并不会发现许多目标。
基本上可以把目标缩小至
布歇赫尔核电厂
和纳坦兹的铀浓缩厂。
因此我对我的助理说，
“给我一个包含我们客户群中所有离心机和发电厂专家的列表。”
我跟他们通了电话，让他们
用他们的专业知识帮忙
分析我们在代码和数据中的发现。
这非常管用。
我们能把这个小的
数字弹头与转子控制器
联系起来了。
这个转子是离心机内部的运动机件，
就是各位看到的那个黑色物体。
如果控制这个转子的速度，
实际上就能破解转子
并甚至最终能让离心机爆炸。
我们也看到了
攻击的目的
是让这一切令人恐怖的事缓慢地发生--
显然这会
让维护工程师们发疯，
他们不可能很快找出问题所在。
大的数字弹头 -- 通过仔细地
观察数据和数据结构，
我们有机会对它有所了解。
例如，数字164
在这些代码中非常引人注目；
不可能忽略它。
我开始研究与这些分离机
如何被建造在纳坦兹
有关的科学文献，
并发现它们被组织在
一个被称为层级的东西之中，
每个层级包含164个离心机。
这有点清楚了，匹配起来了。
甚至更好地匹配了。
在伊朗的这些离心机
被分成15个所谓的机组。
猜测我们在攻击代码中发现了什么？
一个几乎完全相同的机组结构。
因此，再一次地很好地匹配上了。
这在我们所进行的工作上给了我们更多自信。
现在别误会我，它不是像这样进行的。
这些结果中包含了
我们数周的辛苦劳动。
我们常常走入死胡同
并回到起点。
总之，我们找出了
这两个从不同角度
瞄准着同一个目标的
数字弹头。
小弹头选择一个层级，
旋转加速转子，接着让它们慢下来，
然后大弹头
选择六个层级
并操控阀门。
总的来说，我们非常自信
我们确定了目标是什么。
就是纳坦兹，只可能是纳坦兹。
我们并不担心
其他可能被震网病毒
要攻击的目标。
有些我们看到的非常酷的东西 --
确实让我大吃一惊的东西。
这儿下面是灰盒子，
在上面看到的是离心机。
事情是这样的，
它拦截了从传感器发送来的输入值--
例如，来自压力传感器
和震动传感器的输入值 --
并提供合法的代码，
这代码会在攻击期间仍然保持运行，
随代码一起的还有假的输入数据。
事实上，这假的输入数据
是震网病毒事先预存的。
正如好莱坞电影
中的抢劫片段，
观察摄像头被连上了事先录制好的视频。
很酷，不是么？
它的打算显然
不仅是要愚弄控制室中的操作员。
它实际上要更危险，更具侵略性。
它的打算
是要绕过数字安全系统。
我们需要数字安全系统
在那些人类操作员不能做出足够快的行动的地方。
例如，在发电厂，
当巨大的蒸汽轮机转速过快时，
必须在一毫秒内打开安全阀。
显然，人类操作员不可能做到。
因此，在这儿就需要数字安全系统。
而当它们受到损害时，
真正的问题就会出现。
电厂会爆炸。
操作员和安全系统都不会注意到。
这很可怕。
但还会更糟。
我将要说到的，非常重要。
想想这个。
这种攻击是通用的。
它不需要对离心机，
对铀浓缩做什么
具体的事情。
它也将发挥作用，例如，
在一个发电厂
或是一个汽车制造厂。
这很普通。
作为一名攻击者，你不需要 --
不需要用U盘把病毒
传播出去，
如我们在震网病毒这一案例中看到的那样。
你也可以用传统的蠕虫技术进行传播。
尽可能广泛地传播它。
如果做到了这些
最终就会拥有
一个大规模杀伤性的网络武器。
这就是我们不得不
面对的后果。
不幸地是，
这类攻击数量最多的目标
不是在中东。
而是在美国、欧洲和日本。
所有这些绿色的区域，
这些是目标密集的区域。
我们不得不面对这些后果，
我们最好立即开始做准备。
谢谢。
（掌声）
克里斯·安德森：我有个问题。
拉尔夫，广为流传
人们认为摩萨德
是幕后主使。
你怎么看？
拉尔夫·兰纳：好的，你真的想知道？
是的，好吧。
我认为摩萨德牵涉其中，
但主导力量不是以色列。
其后的主导力量
是网络超级大国。
只有一个，
那就是美国 --
很幸运，很幸运。
因为否则的话，
我们面临的问题就更加严重了。
克里斯：谢谢你吓了我们一大跳，谢谢你，拉尔夫。
（掌声）